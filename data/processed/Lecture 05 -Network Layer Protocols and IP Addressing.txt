Page 0
"A.D. 1308 rez
~~ _
Fondamenti di Internet
Network Layer Protocols and IP Addressing

Page 1
) Foreword
Internet Protocol Version 4 (IPv4) is the core protocol suite in the TCP/IP protocol
suite. It works at the network layer in the TCP/IP protocol stack and this layer
corresponds to the network layer in the Open System Interconnection Reference
Model (OSI RM).
The network layer provides connectionless data transmission services. A network
does not need to establish a connection before sending data packets. Each IP data
packet is sent separately.
This presentation describes the basic concepts of IPv4 addresses, subnetting,
network IP address planning, and basic IP address configuration.
Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

) Objectives
¢ Oncompletion of this course, you will be able:
o Describe main protocols at the network layer.
oO Describe the concepts and classification of IPv4 addresses and special IPv4 addresses.
oO Calculate IP networks and subnets.
oO Use the IP network address planning method.
Page 2 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

) Contents
Network Layer Protocols
Introduction to IPv4 Addresses
Subnetting
ICMP
ARP
IPv4 Address Configuration and Basic Application
Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

[= ) Network Layer Protocols
¢ The network layer is often called the IP layer. Network layer protocols include Internet Control
Message Protocol (ICMP) and Internet Packet Exchange (IPX), in addition to IP.
Application Layer
Transport layer
Network layer [iam IP addressing and ICMP IPX
routing
Data link layer
Physical Layer
Equivalent TCP/IP model
Page 4 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

[=| ) Internet Protocol
e IP is short for the Internet Protocol. IP is the name of a protocol file with small content. It defines
and describes the format of IP packets.
¢ The frequently mentioned IP refers to any content related directly or indirectly to the Internet
Protocol, instead of the Internet Protocol itself.
Function Version
*« Provides logical addresses for
devices at the network layer. ¢ IP Version 4 (IPv4)
« Is responsible for addressing and « IP Version 6 (IPv6)
forwarding data packets.
Page 5 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« IP has two versions: IPv4 and |IPv6. IPv4 packets prevail on the Internet, and the Internet is
undergoing the transition to IPv6. Unless otherwise specified, IP addresses mentioned in this
presentation refer
 
to IPv4 addresses.
« |Pv4 is the core protocol in the TCP/IP protocol suite. It works at the network layer in the
TCP/IP protocol stack and this layer corresponds to the network layer in the Open
System Interconnection Reference Model (OSI RM).
2 |Pv6, also called IP Next Generation (IPng), is the second-generation standard protocol
of network layer protocols. Designed by the Internet Engineering Task Force (IETF),
IPv6 is an upgraded version of IPv4.

Ga) ) Data Encapsulation
Application Layer Data PDU
Transport layer Data Segment
Data link layer Data Frame
Physical Layer [LJ LJ kL. Bit
Ethernet IP TCP
header header User data Ethernet tail
Page 6 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ Application data can be transmitted to the destination end over the network only after being
processed at each layer of the TCP/IP protocol suite. Each layer uses protocol data units
(PDUs) to exchange information with another layer. PDUs at different layers contain different
information. Therefore, PDUs at each layer have a particular name.
«= For example, aftera TCP header is added to the upper-layer data in a PDU at the
transport layer, the PDU is called a segment. The data segment is transmitted to the
network layer. After an IP header is added to the PDU at the network layer, the PDU is
called a packet. The data packet is transmitted to the data link layer. After the data link
layer header and tailer are encapsulated into the PDU, the PDU becomes a frame.
Ultimately, the frame is converted into bits and transmitted through network media.
= The process in which data is delivered following the protocol suite from top to bottom
and is added with headers and tails is called encapsulation.
« This presentation describes how to encapsulate data at the network layer. If data is
encapsulated with IP, the packets are called IP packets.

ry) ) IPv4 Packet Format
Ethernet IP TCP
header header header User data Ethernet tail
( . Header Type of
Version Length Service Total Length
Identification Flags Fragment Offset
Fixed size:
20 bytes TTL Protocol Header Checksum
Source IP Address
\ Destination IP Address
Optional size: . .
0-40 bytes < Options Padding
Page 7 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« The IP packet header contains the following information:
2 Version: 4 bits long. Value 4 indicates IPv4. Value 6 indicates IPv6.
« Header Length: 4 bits long, indicating the size of a header. If the Option field is not
carried, the length is 20 bytes. The maximum length is 60 bytes.
2 Type of Service: 8 bits long, indicating a service type. This field takes effect only when
the QoS differentiated service (DiffServ) is required.
«= Total Length: 16 bits long. It indicates the total length of an IP data packet.
2 Identification: 16 bits long. This field is used for fragment reassembly.
2 Flags: 3 bits long.
2 Fragment Offset: 12 bits long. This field is used for fragment reassembly.
a Time to Live: 8 bits long.
= Protocol: 8 bits long. It indicates a next-layer protocol. This field identifies the protocol
used by the data carried in the data packet so that the IP layer of the destination host
sends the data to the process mapped to the Protocol field.
= Common values are as follows:
1: ICMP, Internet Control Message Protocol
2: IGMP, Internet Group Management Protocol
6: TCP, Transmission Control Protocol
17: UDP, User Datagram Protocol
« Header Checksum: 16 bits long.

[= ) Data Packet Fragmentation
¢ The process of dividing a packet into multiple fragments is called fragmentation.
¢ The sizes of IP packets forwarded on a network may be different. If the size of an IP packet
exceeds the maximum size supported by a data link, the packet needs to be divided into several
smaller fragments before being transmitted on the link.
Version Header Type of Total Length
Length Service Ch KS Chk
Identification ‘Flags Fragment Offset pall =
TTL Protocol Header Checksum Host A i a rest
Source IP Address Data fragment
Destination IP Address
Options Padding
Page 8 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ Identification: 16 bits long. This field carries a value assigned by a sender host and is used for
fragment reassembly.
* Flags:
 
3 bits long.
2 Reserved Fragment: 0 (reserved).
2 Don't Fragment: Value 1 indicates that fragmentation is not allowed, and value 0
indicates that fragmentation is allowed.
« More Fragment: Value 1 indicates that there are more segments following the segment,
and value 0 indicates that the segment is the last data segment.
¢ Fragment Offset: 12 bits long. This field is used for fragment reassembly. This field indicates
the relative position of a fragment in an original packet that is fragmented. This field is used
together with the More Fragment bit to help the receiver assemble the fragments.

[=| ) Time to Live
¢ The TTL field specifies the number of routers that a packet can pass through.
¢ Once a packet passes through a router, the TTL is reduced by 1. If the TTL value is reduced to
0, a data packet is discarded.
Header Type of
Version Lenath Servi Total Length
eng ervice TTL = 255 TTL = 254 TTL = 253
Identification Flags Fragment Offset mw M7 mw
TTL Protocol Header Checksum ik
Source IP Address all —
HostA Host
Destination IP Address B
Options Padding
Page 9 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« Time to Live: 8 bits long. It specifies the maximum number of routers that a packet can pass
through on a network.
«> When packets are forwarded between network segments, loops may occur if routes are
not properly planned on network devices. As a result, packets are infinitely looped on
the network and cannot reach the destination. If a loop occurs, all packets destined for
this destination are forwarded cyclically. As the number of such packets increases,
network congestion occurs.
«= To prevent network congestion induced by loops, a TTL field is added to the IP packet
header. The TTL value decreases by 1 each time a packet passes through a Layer 3
device. The initial TTL value is set on the source device. After the TTL value of a packet
decreases to 0, the packet is discarded. In addition, the device that discards the packet
sends an ICMP error message to the source based on the source IP address in the
packet header. (Note: A network device can be disabled from sending ICMP error
messages to the source ends.)

[=| ) Protocol
¢ The Protocol field in the IP packet header identifies a protocol that will continue to process the
packet.
e This field identifies the protocol used by the data carried in the data packet so that the IP layer of
the destination host sends the data to the process mapped to the Protocol field.
Header Type of
IP header} User data
Length Service Total Length
J
Identification Flags Fragment Offset
TTL Header Checksum
Source IP Address
Version
6/17 TCP/UDP
Destination IP Address
Options Padding 1 ICMP
Page 10 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ After receiving and processing the packet at the network layer, the destination end needs to
determine which protocol is used to further process the packet. The Protocol field in the IP
packet header identifies the number of a protocol that will continue to process the packet.
« The field may identify a network layer protocol (for example, ICMP of value 0x01) or an upper-
layer protocol (for example, Transmission Control Protocol [TCP] of value 0x06 or the User
Datagram Protocol [UDP] of value 0x11).

Page 11
) Contents
Network Layer Protocols
Introduction to IPv4 Addresses
Subnetting
ICMP
ARP
IPv4 Address Configuration and Basic Application
Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

Address Classification Address Calculation SpecialAddresses IPv4 vs. IPv6
[=| ) What Is an IP Address?
¢ An IP address identifies a node (or an interface on a network device) on a network.
e IP addresses are used to forward IP packets on the network.
IP Address
An IP address identifies a
node on a network and is
used to find the destination
for data.
Page 12 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
On an IP network, if a user wants to connect a computer
 
to the Internet, the user needs to
apply for an IP address for the computer. An IP address identifies a node on a network and is
used to find the destination for data. We use IP addresses to implement global network
communication.
An IP address is an attribute of a network device interface, not an attribute of the network
device itself. To assign an IP address to a device is to assign an IP address to an interface on
the device. If a device has multiple interfaces, each interface needs at least one IP address.
Note: The interface that needs to use an IP address is usually the interface of a router or
computer.

Address Classification Address Calculation SpecialAddresses IPv4 vs. IPv6
[=| ) IP address Notation
e An |IPv4 address is 32 bits long.
e |tis in dotted decimal notation.
Dotted decimal Decimal TTS é bytes
notation Binary 11000000 = 10101000 +=:00001010 +=: 00000001 32 bits
2’ 2° 2 24 2° 2? 2' 2°
Power
Conversion between 128 64 32 16 8 4 2 1
decimal and binary
systems Bit 1 1 0 0 0 0 0 0
= 128 + 64 =192
e |Pv4 address range is 0.0.0.0—255.255.255.255.
Page 13 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« IP address notation
« An IP address is 32 bits long and consists of 4 bytes. It is in dotted decimal notation,
which is convenient
 
for reading and writing.
¢ Dotted decimal notation
« The IP address format helps us better use and configure a network. However, a
communication device uses the binary mode to operate an IP address. Therefore, it is
necessary to be familiar with the decimal and binary conversion.
« |IPv4 address range
= 00000000.00000000.00000000.00000000—11111119.19911179.194119111.11111111,
that is, 0.0.0.0—255.255.255.255

Address Classification Address Calculation SpecialAddresses IPv4 vs. IPv6
[=| ) IP Address Structure
¢ Network part: identifies a network.
¢ Host part: identifies a host and is used to differentiate hosts on a network.
Network part Host part
Network mask: is used to distinguish the network part from the host part in an IP address.
192. 168. 10.
192.168.101 11000000 10101000 00001010 | 00000001 IP address
255.255.255.0 1111111 1 11111111 11111111 ! 00000000 Network mask
. Network part Host part
Written as i
Page 14 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢« AnIPv4 address is divided into two parts:
a Network part (network ID): identifies a network.
= IP addresses do not show any geographical information. The network ID
represents the network to which a host belongs.
= Network devices with the same network ID are located on the same network,
regardless of their physical locations.
« Host part: identifies a host and is used to differentiate hosts on a network.
« A network mask is also called a subnet mask:
2 A network mask is 32 bits long, which is also represented in dotted decimal notation, like
bits in an IP address.
s The network mask is not an IP address. The network mask consists of consecutive 1s
followed by consecutive Os in binary notation.
= Generally, the number of 1s indicates the length of a network mask. For example, the
length of mask 0.0.0.0 is 0, and the length of mask 252.0.0.0 is 6.
a The network mask is generally used together with the IP address. Bits of 1 correspond
to network bits in the IP address. Bits of 0 corresponds to host bits in the IP address. In
other words, in an IP address, the number of 1s in a network mask is the number of bits
of the network ID, and the number of Os is the number of bits in the host ID.

Address Classification Address Calculation SpecialAddresses IPv4 vs. IPv6
| ) IP Addressing
¢ Network part (network ID): identifies a network.
¢ Host part: identifies a host and is used to differentiate hosts on a network.
Network part ry
Community A No. X, Street Y, John
Layer 2 network addressing Layer 3 network addressing
Community A (network bits)
Layer 2 network Gateway Layer 2 network
10.0.1.0/24 10.0.2.0/24
(jj 10.0.1.1/24 10.0.2.1/24 ij
No. X, Street
 
Y, John
(host bits) Layer 3 network
Page 15 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« A network ID indicates the network where a host is located, which is similar to the function of
"Community A in district B of City X in province Y."
¢« Ahost ID identifies a specific host interface within a network segment defined by the network
ID. The function of host ID is like a host location "No. A Street B".
¢ Network addressing:
a Layer 2 network addressing: A host interface can be found based on an IP address.
« Layer3 network addressing: A gateway is used to forward data packets between
network segments.
* Gateway:
2 During packet forwarding, a device determines a forwarding path and an interface
connected to a destination network segment. If the destination host and source host are
on different network segments, packets are forwarded to the gateway and then the
gateway forwards the packets to the destination network segment.
«> A gateway receives and processes packets sent by hosts on a local network segment
and forwards the packets to the destination network segment. To implement this
function, the gateway must know the route of the destination network segment. The IP
address of the interface on the gateway connected to the local network segment is the
gateway address of the network segment.

Concepts > cero Address Calculation SpecialAddresses _IPv4vs. IPv6
él } IP Address Classification (Classful Addressing)
¢ To facilitate IP address management and networking, IP addresses are classified into the
following classes:
Class A ONNNNNNN UIT TTT TT 0.0.0.0-127.255.255.255
Assigned t
ClassB = 10NNNNNN NNNNNNNN NINININININININ NINININININININ 128.0.0.0-191.255.255.255 hots
Class C 410NNNNN NNNNNNNN NNNNNNNN NINININININININ 192.0.0.0-223.255.255.255
Class D 1110 224.0.0.0-239.255.255.255 Used for multicast
Class E 1111 240.0.0.0-255.255.255.255 Used for research
Default subnet masks of classes A, B, and C
Class A: 8 bits, 0.0.0.0-127.255.255.255/8
Network part
Class B: 16 bits, 128.0.0.0—191.255.255.255/16
Class C: 24 bits, 192.0.0.0-223.255.255.255/24
Page 16 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ To facilitate IP address management and networking, IP addresses are classified into the
following classes:
a The easiest way to determine the class of an IP address is to check the most significant
bits in a network ID. Classes A, B, C, D, and E are identified by binary digits 0, 10, 110,
1110, and 1111, respectively.
« Class A, B, and C addresses are unicast IP addresses (except some special
addresses). Only these addresses can be assigned to host interfaces.
= Class D addresses are multicast IP addresses.
« Class E addresses are used for special experiment purposes.
a This presentation only focuses on class A, B, and C addresses.
¢« Comparison of class A, B, and C addresses:
« A network using class A addresses is called a class A network. A network using class B
addresses is called a class B network. A network that uses class C addresses Is called
a class C network.
= The network ID of a class A network is 8 bits, indicating that the number of network IDs
is small and a large number of host interfaces are supported. The leftmost bit is fixed at
0, and the address space is 0.0.0.0-127.255.255.255.
= The network ID of class B network is 16 bits, which is between class A and class C
networks. The leftmost two bits are fixed at 10, and the address space is 128.0.0.0—
191.255.255.255.
« The network ID of a class C network is 24 bits, indicating that a large number of network
IDs are supported, and the number of host interfaces is small. The leftmost three bits
are fixed at 110, and the address space is 192.0.0.0—223.255.255.255.
* Note:

Concepts > ceeron aD Address Calculation Special Addresses IPv4 vs. IPv6
= ) IP Address Types
e Anetwork range defined by a network ID is called a network segment.
e Network address: identifies a network.
Example: 192.168.10.0/24
e Broadcast address: a special address used to send data * Network and broadcast addresses
cannot be directly used by devices or
to all hosts on a network.
Example: 192.168.10.255/24
their interfaces.
192. 168. 40. ¢ Number of available addresses on a
network segment is 2" — 2 (n is the
e Available addresses: |P addresses that can be allocated to number of bits in the host part).
device interfaces on a network.
Example: 192.168.10.1/24
192. 168. 10. 00000001
Page 17 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
Network address
a The network ID is X, and each bit in the host ID is 0.
2 |t cannot be assigned to a host interface.
Broadcast address
s The network ID is X, and each bit in the host ID is 1.
2 |t cannot be assigned to a host interface.
Available address
« tis also called a host address. It can be assigned to a host interface.
The number of available IP addresses on a network segment is calculated using the following
method:
a Given that the host part of a network segment is n bits, the number of IP addresses is
2", and the number of available IP addresses is 2" — 2 (one network address and one
broadcast address).

Concepts Address Classification 7.\elei¢-Ser
 
fe vie > SpecialAddresses IPv4 vs. IPv6
[=] ) IP Address Calculation
¢ Example: What are the network address, broadcast address, and number of available
addresses of class B address 172.16.10.1/16?
172. 16. 00001010. 00000001
IP address 10101100 00010000:!00001010 00000001
Network mask 11111111 11111111:!00000000 00000000
The network address is obtained,
with all host bits set to Os.
Networkaddress 10101100 00010000:!00000000 00000000 172.16.0.0/16
The broadcast address is obtained,
with all host bits set to 1s.
172.16.255.255/16
Broadcastaddress 10101100 00010000:11111111 111111141
Number of IP 216
 
= 65536 Quiz
addresses
Number of available 916_ 9 = 65534 Example: What are the network address,
addresses broadcast address, and number of available
Range of available 172.16.0.1/16—-172.16.255.254/16 addresses of class
 
A address 10.128.20.10/8?
addresses
Page 18 Copyright
 
© 2020 Huawei Technologies Co., Ltd. All rights reserved.
« Network address: After the host part of this address is set to all Os, the obtained result is the
network address of the network segment where the IP address is located.
¢ Broadcast address: After the host part of this address is set to all 1s, the obtained result is the
broadcast address used on the network where the IP address is located.
* Number of IP addresses: 2", where n indicates the number of host bits.
¢ Number of available IP addresses: 2" — 2, where n indicates the number of host bits.
¢ Answers to the quiz:
2 Network address: 10.0.0.0/8
= Broadcast address: 10.255.255.255
2 Number of addresses: 24
2 Number of available addresses: 2°* — 2
« Range of available addresses: 10.0.0.1/8—10.255.255.254/8

Concepts Address Classification Address Calculation > rg IPv4 vs. IPv6
[= ) Private IP Addresses
¢ Public IP address: An IP address is assigned by the Internet Assigned Numbers Authority (IANA), and this
address allocation mode ensures that each IP address is unique on the Internet. Such an IP address is a
public IP address.
¢ Private IP address: In practice, some networks do not need to connect to the Internet. For example, ona
network of a lab in a college, IP addresses of devices need to avoid conflicting with each other only within
the same network. In the IP address space, some IP addresses of class A, B, and C addresses are
reserved for the preceding situations. These IP addresses are called private IP addresses.
2 Class A: 10.0.0.0-10.255.255.255 veo 168 1008
10.0.0.0/8 =
= Class B: 172.16.0.0-172.31.255.255 implemented using network
Internet i
2 Class C: 192.168.0.0-192.168.255.255 © address translation (NAT)
10.0.0.0/8 192.168.1.0/24
Connecting a private network to the Internet
Page 19 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« Private IP addresses are used to relieve the problem of IP address shortage. Private
addresses are used on internal networks and hosts, and cannot be used on the public
network.
« Public IP address: A network device connected to the Internet must have a public IP
address allocated by the IANA.
= Private IP address: The use of a private IP address allows a network to be expanded
more freely, because a same private IP address can be repeatedly used on different
private networks.
* Connecting a private network to the Internet: A private network is not allowed to connect to the
Internet because it uses a private IP address. Driven by requirements, many private networks
also need to connect to the Internet to implement communication between private networks
and the Internet, and between private networks through the Internet. The interconnection
between the private network and Internet must be implemented using the NAT technology.
¢ Note: Network Address Translation (NAT) is used to translate addresses between private and
public IP address realms.

Concepts Address Classification Address Calculation > rg IPv4 vs. IPv6
[=] ) Special IP Addresses
¢ Some IP addresses in the IP address space are of special meanings and functions.
¢ For example:
It can be used as a destination address and traffic destined for
Limited broadcast address = 255.255.255.255 it is sent to all hosts on the network segment to which the
address belongs. (Its usage is restricted by a gateway).
It is an address of any network.
Any IP address 0.0.0.0 Addresses in this block refer to source hosts on "this" network.
Loopback address 127.0.0.0/8 It is used to test the software system of a test device.
If
 
a host fails to automatically obtain an IP address, the host
Link-local address 169.254.0.0/24 can use an IP address in this address block for temporary
communication.
Page 20 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
295.255.255.255
s This address is called a limited broadcast address and can be used as the destination
IP address of an IP packet.
a After receiving an IP packet whose destination IP address is a limited broadcast
address, the router stops forwarding the IP packet.
0.0.0.0
« |f this address is used as a network address, it means the network address of any
network. If this address is used as the IP address of a host interface, it is the IP address
of a source host interface on "this" network.
= For example, if a host interface does not obtain its IP address during startup, the host
interface can send a DHCP Request message with the destination IP address set to a
limited broadcast address and the source IP address set to 0.0.0.0 to the network. The
DHCP server is expected to allocate an available IP address to the host interface after
receiving the DHCP Request message.
* 127.0.0.0/8
« This address is called a Loopback address and can be used as the destination IP
address of an IP packet. It is used to test the software system of a test device.
«= The IP packets that are generated by a device and whose destination IP address is set
to a Loopback address cannot leave the device itself.
* 169.254.0.0/16
2 lf a network device is configured to automatically obtain an IP address but no DHCP
server is available on the network, the device uses an IP address in the 169.254.0.0/16
network segment for temporary communication.
« Note: The Dynamic Host Configuration Protocol (DHCP) is used to dynamically allocate
network configuration parameters, such as IP addresses.

Concepts Address Classification Address Calculation SpecialAddresses IPv4 vs. IPv6
[=| ) IPv4 vs. IPv6
e |IPv4 addresses managed by the IANA were exhausted in 2011. As the last public IPv4 address
was allocated and more and more users and devices access the public network, IPv4 addresses
were exhausted. This is the biggest driving force for IPv6 to replace IPv4.
¢ Address length: 32 bits « Address length: 128 bits
¢ Address types: unicast address, broadcast « Address types: unicast address, multicast
address, and multicast address address, and anycast address
¢ Characteristics: * Characteristics:
IPv4 address depletion e Unlimited number of addresses
Inappropriate packet header design ° Simplified packet header
ARP dependency-induced flooding e Automatic IPv6 address allocation
Page 21 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

Page 22
) Contents
Network Layer Protocols
Introduction to IPv4 Addresses
Subnetting
ICMP
ARP
IPv4 Address Configuration and Basic Application
Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

Page 23
Ga) ) Why Subnetting?
172.16.0.1 172.16.0.2 172.16.0.253 172.16.0.254
_I _I I _T
172.16.0.0
2'§ = 65536 IP addresses
« Aclass B address is used for a broadcast
domain, wasting addresses.
The broadcast domain is too large. Once
broadcast occurs, an internal network is
overloaded.
172.16.1.0
+h
Ohi
172.16.3.0
Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
&
ci Ga li
172.16.2.0
¢« Anetwork number is divided into multiple
subnets, and each subnet is allocated to a
separate broadcast domain.
¢ Inthis way, the broadcast domain is smaller,
and the network planning is more reasonable.
« IP addresses are properly used.
Classful addressing is too rigid and the granularity of address division is too large. As a result,
a large number of host IDs cannot be fully used, wasting IP addresses.
Therefore, subnetting can be used to reduce address waste through the variable length
subnet mask (VLSM) technology. A large classful network is divided into several small
subnets, which makes the use of IP addresses more scientific.

Subnetting - Analyzing the Original Network
Segment
¢ Example: 192.168.10.0/24
192.168.10.1
IP address 192. 168. 1
Default subnet
mask
°
}o[o[o}
 
0/0} o} 0} +]
255. 255. 255. 00000000 One class
 
C network:
192.168.10.0/24
192.168.10.255 Default subnet mask:
299.255.255.0
IP address 192. 168. 10.
Default 255. 255. 255. 00000000
subnet mask
Network part Host part
Network address: 192.168.10.0/24
Broadcast address: 192.168.10.255
Total IP addresses: 2° = 256
Available IP addresses: 2° — 2 = 254
Page 24 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« Assume that a class C network segment is 192.168.10.0. By default, the network mask is 24
bits, including 24 network bits and 8 host bits.
¢« As calculated, there are 256 IP addresses on the network.

=| ) Subnetting - Taking Bits from the Host Part
¢ Bits can be taken from the host part to create subnets.
Take 1 bit from the host part.
—_——————=—=—=>
Wa
Padres 192 168 « POOO000o
New mask 255. 255. 255. 10000000 Two subnets:
Subnet 1: 192.168.10.0/25
Subnet 2: 192.168.10.128/25
IP address 192. 168. 10. New mask: 255.255.255.128
New mask 255. 255. 255. 10000000
Network part ' Host part
Subnet bits
A Total IP addresses: 2’
 
= 128
* Variable length subnet mask (VLSM) Available IP addresses: 2’ — 2 = 126
Page 25 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
Now, for the original 24-bit network part, a host bit is taken to increase the network part to 25
bits. The host part is reduced to 7 bits. The taken 1 bit is a subnet bit. In this case, the network
mask becomes 25 bits, that is, 255.255.255.128, or /25.
Subnet bit: The value can be 0 or 1. Two new subnets are obtained.
As calculated, there are 128 IP addresses on the network.

Subnetting - Calculating the Subnet Network
Address
e The network address is obtained, with all host bits set to Os.
GZ
192.168.10.0 192. 168. 10. 00000000
New mask /25 255. 255. 255. 10000000
Ne Ne yy,
~a a
Network part Host part
Subnet 1's
192.168.10.0/25
network address — — 10. }0}0}0|0]0}0]0] 0
Subnet 2's 192. 168. 10.
}4}0}0/0/0/0] 0/0) 192.168.10.128/25
ZA
network address
Page 26 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢« Calculate a network address, with all host bits set to Os.
s |f the subnet bit is 0, the network address is 192.168.10.0/25.
> |f the subnet bit is 1, the network address is 192.168.10.128/25.

= Subnetting - Calculating the Subnet
Broadcast Address
e The broadcast address is obtained, with all host bits set to 1s.
Wa
192.168.10.0 192. 168. 10. 0000000 0
New mask /25 255. 255. 255. 10000000
Ne Ne S
YY YY
Network part Host part
Subnet 1's
192.168.10.0/25
network address — — 10. }}0}0}0]0]0]0/0|
Subnet 1' ”
ubnet 1's 192. 168. 40. fofajaiaiafafala| 192.168.10.127/25
broadcast address 7
Subnet 2's
192.168.10.128/25
network address 192. 168. 10. }1/0}0}0}0/0/0/0]
Subnet 2' mn
ubnet 2's 192. 168. 10. afafafa[afafata| 192.168.10.255/25
broadcast address =
Page 27 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢« Calculate a broadcast address, with all host bits set to 1s.
> |f the subnet bit is 0, the network address is 192.168.10.127/25.
> |f the subnet bit is 1, the network address is 192.168.10.255/25.

10 hosts
ao
30 hosts
hi
cl
Ci
&
&
Ci Ca
10 hosts
Page 28 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
Ga) ) Practice: Computing Subnets (1)
* Question: An existing class C network segment
is 192.168.1.0/24. Use the VLSM to allocate IP
addresses to three subnets.
¢ Answer: (Use a network with 10 hosts as an example.)
Step 1: Calculate the number of host bits to be taken.
2°-2210
n 24, host bits
Step 2: Take bits from the host part.
Take 4 bits from the host part.
or
00000000
111410000
|
Subnet bits
IPaddress 192. 168. 1.
Subnet mask 255. 255. 255.
Number of subnets:
24 = 16 subnets
¢ In actual network planning, the subnet with more hosts is planned first.

Ga) ) Practice: Computing Subnets (2)
* Question: An existing class C network segment
is 192.168.1.0/24. Use the VLSM to allocate IP
192.168.1.0/28 addresses to three subnets.
10 hosts
Chk i hj 30 hosts ¢« Answer: (Use a network with 10 hosts as an example.)
~T al ti Step 3: Calculate subnet network addresses.
VZLLLLLLLLL
 
LLL LLL,
_ IPaddress 192. 168. 1. 00000000
® & {_]k New mask 255. 255. 255. 11110000
~ vf Network address
r fz = Subnet1 192. 168. 1. 00 0 0. 192.168.1.0/28
Subnet2 192 168. 1. 000 0 192.168.1.16/28
NOUIESIS |
 
LULU
192.168.1.16/28 Subnet3 192. 168. 1. (Ye 00 0 0 192.168.1.32/28
Wd
Subnet
 
16 192. 168. 1. [EINER
 
0 0 0 0 192.168.1.240/28
LLLLLLZELELLLLLLLLLA
Page 29 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ Subnet network addresses are:
a 192.168.1.0/28
a 192.168.1.16/28
a 192.168.1.32/28
a 192.168.1.48/28
a = 192.168.1.64/28
a =192.168.1.80/28
a = 192.168.1.96/28
a §192.168.1.112/28
a §192.168.1.128/28
a 192.168.1.144/28
a =192.168.1.160/28
a 192.168.1.176/28
a 192.168.1.192/28
a 192.168.1.208/28
a 192.168.1.224/28
a 192.168.1.240/28

Page 30
) Contents
Network Layer Protocols
Introduction to IPv4 Addresses
Subnetting
ICMP
ARP
IPv4 Address Configuration and Basic Application
Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

[=| ) ICMP
¢ The Internet Control Message Protocol (ICMP) is an auxiliary protocol of the IP protocol.
ICMP is used to transmit error and control Ethernet IP ICMP message _ Ethernet tail
header header
information between network devices. It plays
an important role in collecting network Type Code Checksum
information, diagnosing and rectifying network ICMP message content
faults
0 0 Echo Reply
Message 3 0 Network Unreachable
= >
Chk < Ch 3 1 Host Unreachable
==! TM
Host A Message
‘N
3 2 Protocol Unreachable
3 3 Port Unreachable
5 0 Redirect
8 0 Echo Request
Page 31 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
To improve the efficiency of IP data packet forwarding and success rate of packet exchanges,
ICMP is used at the network layer. ICMP allows hosts and devices to report errors during
packet transmission.
ICMP message:
«> ICMP messages are encapsulated in IP packets. Value 1 in the Protocol field of the IP
packet header indicates ICMP.
a Explanation of fields:
= The format of an ICMP message depends on the Type and Code fields. The Type
field indicates a message type, and the Code field contains a parameter mapped
to the message type.
= The Checksum field is used to check whether a message is complete.
= Amessage contains a 32-bit variable field. This field is not used and is usually set
to 0.
- InanICMP Redirect message, this field indicates the IP address of a
gateway. A host redirects packets to the specified gateway that is assigned
this IP address.
— In an Echo Request message, this field contains an identifier and a
sequence number. The source associates the received Echo Reply
message with the Echo Request message sent by the local end based on
the identifiers and sequence numbers carried in the messages. Especially,
when the source sends multiple Echo Request messages to the destination,
each Echo Reply message must carry the same identifier and sequence
number as those carried in the Echo Request message.

) ICMP Redirection
¢ ICMP Redirect messages are a type of ICMP control message. When a router detects that a
host uses a non-optimal route in a specific scenario, the router sends an ICMP Redirect
message to the host, requesting the host to change the route.
z Server A Internet
20.0.0.1/24
20.0.0.2/24
RT RQ
A
10.0.0.200/24 | 3] O :
 
4
RT
B
——- 10.0.0.100/24
. © ive
 
ICMP Redirect message
|
IP address: 10.0.0.1/24
HostA = Default gateway: 10.0.0.100
Page 32 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ ICMP redirection process:
1. Host A wants to send packets to server A. Host A sends packets to the default gateway
address that is assigned to the gateway RTB.
2. After receiving the packet, RTB checks packet information and finds that the packet
should be forwarded to RTA. RTA is the other gateway on the same network segment
as the source host. This forwarding path through RTA is better than that through RTB.
Therefore, RTB sends an ICMP Redirect message to the host, instructing the host to
send the packet to RTA.
3. After receiving the ICMP Redirect message, the host sends a packet to RTA. Then
RTA forwards the packet to server A.

[=| ) ICMP Error Detection
¢ ICMP Echo messages are used to check network connectivity between the source and
destination and provide other information, such as the round-trip time.
Echo
Request
10.0.0.0/24
20.0.0.0/24
RT | 2 “RT 1 oho 2 Server
 
A
A B Reply
Function: Ping
Ping is a command used on network devices, Windows OS, Unix
OS, and Linux OS. Ping is a small and useful application based on
the ICMP protocol.
A ping tests the reachability of a destination node.
Page 33 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
[RTA]ping 20.0.0.2
PING 20.0.0.2: 56 data bytes, press CTRL_C to break
Reply from 20.0.0.2: bytes=56 Sequence=1 ttI=254 time=70 ms
Reply from 20.0.0.2: bytes=56 Sequence=2 ttI=254 time=30 ms
Reply from 20.0.0.2: bytes=56 Sequence=3 ttl=254 time=30 ms
Reply from 20.0.0.2: bytes=56 Sequence=4 ttl=254 time=40 ms
Reply from 20.0.0.2: bytes=56 Sequence=5 ttI=254 time=30 ms
--- 20.0.0.2 ping statistics ---
5 packet(s) transmitted
5 packet(s) received
0.00% packet loss
round-trip min/avg/max = 30/40/70 ms
A typical ICMP application is ping. Ping is a common tool used to check network connectivity
and collect other related information. Different parameters can be specified in a ping
command, such as the size of ICMP messages, number of ICMP messages sent at a time,
and the timeout period for waiting for a reply. Devices construct ICMP messages based on the
parameters and perform ping tests.

[=] ) ICMP Error Report
e ICMP defines various error messages for diagnosing network connectivity problems. The source can
determine the cause for a data transmission failure based on the received error messages. For example,
after a network device receives a packet, it cannot access the network where the destination device
resides, the network device automatically sends an ICMP Destination Unreachable message to the source.
Data packet [RTA]tracert 20.0.0.2
& 10.0.0.0/24 & 20.0.0.0/24 z traceroute to 20.0.0.2(20.0.0.2), max hops: 30 ,packet length:
A 2 ‘ 2 40,press CTRL_C
RTA RTB ServerA to break
aA
> J
Destination Unreachable message
1 10.0.0.2 80 ms 10 ms 10 ms
Function: Tracert
Tracert checks the reachability of each hop on a forwarding path 2 20.0.0.2 30 ms 30 ms 20 ms
based on the TTL value carried in the packet header.
Tracert is an effective method to detect packet loss and delay on a
network and helps administrators discover routing loops on the
network.
Page 34 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ ICMP defines various error messages for diagnosing network connectivity problems. The
source can determine the cause for a data transmission failure based on the received error
messages.
2 |faloop occurs on the network, packets are looped on the network, and the TTL times
out, the network device sends a TTL timeout message to the sender device.
a If the destination is unreachable, the intermediate network device sends an ICMP
Destination Unreachable message to the sender device. There are a variety of cases for
unreachable destination. If the network device cannot find the destination network, the
network device sends an ICMP Destination Network Unreachable message. If the
network device cannot find the destination host on the destination network, the network
device sends an ICMP Destination Host Unreachable message.
¢ Tracertis a typical ICMP application. Tracert checks the reachability of each hop ona
forwarding path based on the TTL value carried in the packet header. In a tracert test for a
path to a specific destination address, the source first sets the TTL value in a packet to 1
before sending the packet. After the packet reaches the first node, the TTL times out.
Therefore, the first node sends an ICMP TTL Timeout message carrying a timestamp to the
source. Then, the source sets the TTL value in a packet to 2 before sending the packet. After
the packet reaches the second node, the TTL times out. The second node also returns an
ICMP TTL Timeout message. The process repeats until the packet reaches the destination. In
this way, the source end can trace each node through which the packet passes based on the
information in the returned packet, and calculate the round-trip time based on timestamps.

Page 35
) Contents
Network Layer Protocols
Introduction to IPv4 Addresses
Subnetting
ICMP
ARP
IPv4 Address Configuration and Basic Application
Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

Application Transport Network Data Link Physical
Layer Layer Layer Layer Layer
[=| ) ARP
e Address Resolution Protocol (ARP):
o Discovers the MAC address associated with a given IP address.
ARP request
Destination IP address: 192.168.1.2
m&% Destination MAC address: ?
TT 1]
Host A[ |p TS | Jp tost 8
192.168.1.1/24 192.168.1.2/24
3C-52-82-49-7E-9D ARP reply IY 48-A4-72-1C-8F-4F
Source IP address: 192.168.1.2
Source MAC address: 48-A4-72-1C-8F-4F
Page 36 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« The Address Resolution Protocol (ARP) is a TCP/IP protocol that discovers the data link layer
address associated with a given IP address.
¢ ARP is an indispensable protocol in IPv4. It provides the following functions:
= Discovers the MAC address associated with a given IP address.
a Maintains and caches the mapping between IP addresses and MAC addresses through
ARP entries.
« Detects duplicate IP addresses on a network segment.

@) >) ARP Implementation Principles (1)
No
S
Host 1 checks Host 1 ©) Host 2
cached ARP entries. ; ;
i }— GE 0/0/1 GE 0/0/2 =
Host 1 sends an ARP (
request. = =n Bl
IP
 
1: 192.168.1.1/24 IP 2:192.168.1.2/24
Host 2 adds an ARP MAC 1: 3C-52-82-49-7E-9D MAC 2: 48-A4-72-1C-8F-4F
entry. 1)
Host 2 sends an ARP Step 1:
reply. Host 4 .
ost 1>arp -a : + Before sending a datagram, a device searches
Internet Address PhysicalAddress Type its ARP table for the destination MAC address of
Host 1 adds an ARP the datagram.
entry.
If the destination MAC address exists in the
ARP table, the device encapsulates the MAC
The ARP cache address in the frame and sends out the frame. If
table is empty. the destination MAC address does not exist in
the ARP table, the device sends an ARP request
to discover the MAC address.
Page 37 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ Generally, a network device has an ARP cache. The ARP cache stores the mapping between
IP addresses and MAC addresses.
¢ Before sending a datagram, a device searches its ARP table. If a matching ARP entry is
found, the device encapsulates the corresponding MAC address in the frame and sends out
the frame. If a matching ARP entry is not found, the device sends an ARP request to discover
the MAC address.
« The learned mapping between the IP address and MAC address is stored in the ARP table for
a period. Within the validity period (180s by default), the device can directly search this table
for the destination MAC address for data encapsulation, without performing ARP-based query.
After the validity period expires, the ARP entry is automatically deleted.
* If the destination device is located on another network, the source device searches the ARP
table for the gateway MAC address of the destination address and sends the datagram to the
gateway. Then, the gateway forwards the datagram to the destination device.

@) >) ARP Implementation Principles (2)
S YA
Pos
Host 1 checks cached Host 1 o Host 2
ARP entries. ’ 3) ;
i = GE 0/0/1 GE 0/0/2 =
Host 1 sends an ARP ( > TC
request. — 4 —e
IP
 
1: 192.168.1.1/24 IP
 
2: 192.168.1.2/24
Host 2 adds an ARP MAC 1: 3C-52-82-49-7E-9D MAC 2:48-A4-72-1C-8F-4F
entry.
Sal! Step 2:
Host 2 sends an ARP 2) * Host 1 sends an ARP request to discover
reply. Eth_ll ARP Request FCS the MAC address of Host 2.
_ * The destination MAC address in the ARP
Host 1 adds an ARP | request is 0 because the destination MAC
entry. Destination MAC address is unknown.
address: Operation type: ARP request
FF-FF-FF-FF-FF-FF MAC address of the sender: MAC 1
Source MAC address: __|P address of the sender: IP 1 Step 3:
MAC 1 Destination MAC address: 00-00-00-00-00-00
The ARP request message is a broadcast
data frame. After receiving the ARP request
message, the switch floods it.
Destination IP address: IP 2
Page 38 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ In this example, the ARP table of Host 1 does not contain the MAC address of Host 2.
Therefore, Host 1 sends an ARP request message to discover the destination MAC address.
¢« The ARP request message is encapsulated in an Ethernet frame. The source MAC address in
the frame header is the MAC address of Host 1 at the transmit end. Because Host 1 does not
know the MAC address of Host 2, the destination MAC address is the broadcast address FF-
FF-FF-FF-FF-FF.
¢« The ARP request message contains the source MAC address, source IP address, destination
MAC address, and destination IP address. The destination MAC address is all Os. The ARP
request message is broadcast to all hosts on the network, including gateways.

@) >) ARP Implementation Principles (3)
YY
Pos
Host 1 checks Host 1 (©) Host 2
cached ARP entries. ; ;
| = GE 0/0/1 GE 0/0/2 =
Host 1 sends an ARP ( |
request. —
IP
 
1: 192.168.1.1/24 IP
 
2: 192.168.1.2/24
[tes 2 adds an ARP) MAC 1: 3C-52-82-49-7E-9D MAC 2: 48-A4-72-1C-8F-4F
entry. (4)
Step 4:
Host 2 sends an ARP
reply. * After receiving the ARP request message, each host Host 2>arp -a
checks whether it is the destination of the message based Internet Address Physical Address Type
on the carried destination IP address. 192.168.1.1 3C-52-82-49-7E-9D Dynamic
Host 1 adds an ARP a on
entry. * Host 2 finds that it is the destination of the message and
then records the mapping between the sender's MAC and
IP addresses in its ARP table.
Page 39 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« After receiving the ARP request message, each host checks whether it is the destination of
the message based on the carried destination IP address. If not, the host does not respond to
the ARP request message. If so, the host adds the sender's MAC and IP addresses carried in
the ARP request message to the ARP table, and then replies with an ARP reply message.

Application Transport
Layer Layer
@))) ARP Implementation Principles (4)
YY
Pos
Host 1 checks Host 1 o
cached ARP entries.
Host 2
| { Tk GE 0/0/1 GE 0/0/2 6 | ( lj
Host 1 sends an ARP ( —— — (
— I
request.
IP 1: 192.168.1.1/24
Host2 adds an ARP _—-
 
MAC 1: 3C-52-82-49-7E-9D
entry.
Step 5:
[Hest 2 sends an ARP! * Host 2 sends anARP reply to Host 1.
reply. In this step, Host 2 has discovered the MAC address of Host
if 1, s0 the ARP reply is a unicast data frame.
Host 1 adds an ARP
entry.
Step 6:
After receiving the unicast data frame, the switch forwards the
frame.
Page 40 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
Network Data Link Physical
Layer Layer Layer
IP 2: 192.168.1.2/24
MAC 2: 48-A4-72-1C-8F-4F
5 ] V
Eth_Il
i
Destination MAC
address: MAC-1
Source MAC address:
MAC 2
ARP Reply FCS
Operation type: ARP reply
Sender's MAC address: MAC 2
Sender's IP address: |P 2
Receiver's MAC address: MAC 1
Receiver's IP address: IP 1
Host 2 sends an ARP reply message to Host 1.
In the ARP reply message, the sender's IP address is the IP address of Host 2 and the
receiver's IP address is the IP address of Host 1. The receiver's MAC address is the MAC
address of Host 1 and the sender's MAC address is the MAC address of Host 2. The
operation type Is set to reply.
¢ ARP reply messages are transmitted in unicast mode.

Application Transport Network Data Link Physical
Layer Layer Layer Layer Layer
@) >) ARP Implementation Principles (5)
Host 1 checks Host 1
cached ARP entries. ;
i = GE 0/0/1
Host 1 sends an ARP (
request. —
J IP 1: 192.168.1.1/24
Host 2 adds an ARP MAC 1: 3C-52-82-49-7E-9D
entry.
\ 7
 
)
Host 2 sends an ARP
Host 1>arp -a
reply.
| Internet Address Physical Address
192.168.1.2 48-A4-72-1C-8F-4F
Host 1 adds an ARP
entry.
Page 41 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
&
Pos
() Host 2
GE 0/0/2 _|k
IP 2: 192.168.1.2/24
MAC 2: 48-A4-72-1C-8F-4F
Step 7:
After receiving the ARP reply message, Host 1 checks
Type whether it is the destination of the message based on
Dynamic the carried destination IP address.
If so, Host 1 records the carried sender's MAC and IP
addresses in its ARP table.
¢ After receiving the ARP reply message, Host 1 checks whether it is the destination of the
message based on the carried destination IP address. If so, Host 1 records the carried
sender's MAC and IP addresses in its ARP table.

Page 42
) Contents
Network Layer Protocols
Introduction to IPv4 Addresses
Subnetting
ICMP
ARP
IPv4 Address Configuration and Basic Application
Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

Ga) ) Basic IP Address Configuration Commands
1. Enter the interface view.
[Huawei] interface interface-type interface-number
You can run this command to enter the view of a specified interface and configure attributes for the interface.
« interface-type interface-number. specifies the type and number of an interface. The interface type and number
can be closely next to each other or separated by a space character.
2. Configure an IP address for the interface.
[Huawei-GigabitEthernet0/0/1] ip address ip-address { mask | mask-length }
You can run this command in the interface view to assign an IP address to the interface on the network devices to
implement network interconnection.
ip-address: specifies the IP address of an interface. The value is in dotted decimal notation.
mask: specifies a subnet mask. The value is in dotted decimal notation.
mask-length: specifies a mask length. The value is an integer ranging from 0 to 32.
Page 43 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.

Case:
Configuring an IP address for an Interface
Configure an IP address for a physical interface.
192.168.1.1/24 192.168.1.2/24
[RTA] interface gigabitethernet 0/0/1
GEO/0/1 GEO/0/1
& & [RTA-GigabitEthernet0/0/1] ip address 192.168.1.1 255.255.255.0
RTA RTB Or,
Loopback 0 Loopback 0 [RTA-GigabitEthernet0/0/1] ip address 192.168.1.1 24
1.1.1.1/32 2.2.2.2/32
Configure an IP address for a logical interface.
On the preceding network where the two
routers are interconnected, configure IP
addresses for the interconnected physical
interfaces and logical IP addresses.
[RTA] interface LoopBack 0
[RTA-LoopBackO] ip address 1.1.1.1 255.255.255.255
Or,
[RTA-LoopBackO] ip address 1.1.1.1 32
Page 44 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
¢ Physical interface: is an existing port on a network device. A physical interface can be a
service interface transmitting services or a management interface managing the device. For
example, a GE service interface and an MEth management interface are physical interfaces.
¢ Logical interface: is a physically nonexistent interface that can be created using configuration
and need to transmit services. For example, a VLANIF interface and Loopback interfaces are
logical interfaces.
2 Loopback interface: is always in the up state.
= Once a Loopback interface is created, its physical status and data link protocol
status always stay up, regardless of whether an IP address is configured for the
Loopback interface.
= The IP address of a Loopback interface can be advertised immediately after being
configured. A Loopback interface can be assigned an IP address with a 32-bit
mask, which reduces address consumption.
= No data link layer protocols can be encapsulated on a Loopback interface. No
negotiation at the data link layer is performed for the Loopback interface.
Therefore, the data link protocol status of the Loopback interface is always up.
= The local device directly discards a packet whose destination address is not the
local IP address but the outbound interface is the local Loopback interface.

[=] ) Network IP Address Planning
e IP address planning must be considered together with the network structure, routing protocols,
traffic planning, and service rules. In addition, IP address planning should be corresponding to
the network hierarchy and performed in a top-bottom way.
e In conclusion, IP address planning objectives are to achieve easy management, easy scalability,
and high utilization. Reference Planning Rules
Uniqueness, continuity, and scalability
* IP Address Planning Example
Address
Network segment of the 192.168.1.0/24
Structured and service-related
Core node
R&D department
Example:
. Network segment of the .
A company is marketing department 192.168.2.0/24 Aggregation node
assigned
192.168.0.0/16 Network segmentofthe = 499
 
168.3. o/24
as a network administrative department
segment Access node
address. Network segment ofthe 499 168.4.0/24
guest center R&D Dent Marketing Administration | Guest
Others . ” Dept. Dept. center
Page 45 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.
« Planning rules:
a Uniqueness: Each host on an IP network must have a unique IP address.
« Continuity: Contiguous addresses can be summarized easily in the hierarchical
networking. Route summarization reduces the size of the routing table and speeds up
route calculation and route convergence.
« Scalability: Addresses need to be properly reserved at each layer, ensuring the
contiguous address space for route summarization when the network is expanded. Re-
planning of addresses and routes induced by network expansion Is therefore prevented.
«= Combination of topology and services: Address planning is combined with the network
topology and network transport service to facilitate route planning and quality of service
(QoS) deployment. Appropriate IP address planning helps you easily determine the
positions of devices and types of services once you read the IP addresses.

[Figura da Pag.1] Labels: eg Wha” 7; - wt; >; i " x CRALE C/ * -; soperne em Pe... a ee > < ee; Wie S 4) / > atcew kg >.. Caption: (errore caption)
[Figura da Pag.1] Labels: sae ee ae eh: ays 6) ~~ A.B. 1308 es yy Ae rm 2; SD — <——=; Q M5) 4 UNIVERSITA DEGLI STUDI; MCCS DI PERUGIA. Caption: (errore caption)
[Figura da Pag.1] Labels: Fondamenti di Internet; Network Layer Protocols and IP Addressing. Caption: (errore caption)
[Figura da Pag.2] Labels: ) Foreword; e Internet Protocol Version 4 (IPv4) is the core protocol suite in the TCP/IP protocol; suite. It works at the network layer in the TCP/IP protocol stack and this layer. Caption: (errore caption)
[Figura da Pag.2] Labels: corresponds to the network layer in the Open System Interconnection Reference; Model (OSI RM).; ¢ The network layer provides connectionless data transmission services. A network; does not need to establish a connection before sending data packets. Each IP data; nacket is cant sceanarately. Caption: (errore caption)
[Figura da Pag.2] Labels: ba; ¢ This presentation describes the basic concepts of IPv4 addresses, subnetting,; network IP address planning, and basic IP address configuration.; Page 1 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.3] Labels: oF ) Objectives; ¢ Oncompletion of this course, you will be able:; © Describe main protocols at the network layer.. Caption: (errore caption)
[Figura da Pag.3] Labels: © Describe the concepts and classification of IPv4 addresses and special IPv4 addresses.; o Calculate IP networks and subnets.; o Use the IP network address planning method.. Caption: (errore caption)
[Figura da Pag.3] Labels: Page 2 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.4] Labels: Contents; 1. Network Layer Protocols; 2. Introduction to |IPv4 Addresses. Caption: (errore caption)
[Figura da Pag.4] Labels: 3. Subnetting; 4. ICMP; 5. ARP; 6. IPv4 Address Configuration and Basic Application. Caption: (errore caption)
[Figura da Pag.4] Labels: Page 3 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.5] Labels: Network Layer Protocols; ¢ The network layer is often called the IP layer. Network layer protocols include Internet Control; Message Protocol (ICMP) and Internet Packet Exchange (IPX), in addition to IP.. Caption: (errore caption)
[Figura da Pag.5] Labels: Application Layer; Transport layer; NEC aENCae -- (P addressing and ICMP IPX; routing Ip; Data link layer; Physical Layer. Caption: (errore caption)
[Figura da Pag.5] Labels: Equivalent TCP/IP model; Page 4 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.6] Labels: Internet Protocol; ¢ IP is short for the Internet Protocol. IP is the name of a protocol file with small content. It defines; and describes the format of IP packets.. Caption: (errore caption)
[Figura da Pag.6] Labels: ¢ The frequently mentioned IP refers to any content related directly or indirectly to the Internet; Protocol, instead of the Internet Protocol itself.; + Provides logical addresses for. Caption: (errore caption)
[Figura da Pag.6] Labels: USVICES ALUIe TWO layer. e IF VErslorl & UIP Vs); « Is responsible for addressing and + IP Version 6 (IPv6); forwarding data packets.; Page 5 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.7] Labels: Data Encapsulation; Application Layer Data PDU. Caption: (errore caption)
[Figura da Pag.7] Labels: Transport layer Data segment; i Data Packe; t; Data link layer Data Frame; Physical Layer [| |] [| Bit. Caption: (errore caption)
[Figura da Pag.7] Labels: — fee Ll | et; Ethernet IP TCP .; User data Ethernet tail; header header header; Page 6 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.8] Labels: IPv4 Packet Format; Fipemmet hewder hoster User data Ethernet tail. Caption: (errore caption)
[Figura da Pag.8] Labels: . Header Type of; Version Length Service Total Length; Identification Flags Fragment Offset; Fixed size:; 20 bytes TTL Protocol Header Checksum; Source IP Address. Caption: (errore caption)
[Figura da Pag.8] Labels: ( Destination IP Address; Optional size: F ,; 0-40 bytes < Options Padding; Page 7 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.9] Labels: Data Packet Fragmentation; ¢ The process of dividing a packet into multiple fragments is called fragmentation.; ¢ The sizes of IP packets forwarded on a network may be different. If the size of an IP packet. Caption: (errore caption)
[Figura da Pag.9] Labels: exceeds the maximum size supported by a data link, the packet needs to be divided into several; smaller fragments before being transmitted on the link.; : Header Type of; Version Length | Service Total Length Ci i; Identification ‘Flags | Fragment Offset = > CJ; TTL Protocol Header Checksum Host A Rear iT Ff Host. Caption: (errore caption)
[Figura da Pag.9] Labels: a aie OC; Source IP Address Data fragment; Destination IP Address; Options Padding; Page 8 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.10] Labels: Time to Live; ¢ The TTL field specifies the number of routers that a packet can pass through.; ¢ Once a packet passes through a router, the TTL is reduced by 1. If the TTL value is reduced to. Caption: (errore caption)
[Figura da Pag.10] Labels: 0, a data packet is discarded.; Version Header Up al Total Length; eng cINvIce TTL = 255 TTL = 254 TTL = 253; Identification Flags Fragment Offset; Protocol Header Checksum _i—-& K&S i; Source IP Address — —; bHact A Bact. Caption: (errore caption)
[Figura da Pag.10] Labels: Destination IP Address B; Options Padding; Page 9 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.11] Labels: ¢ The Protocol field in the IP packet header identifies a protocol that will continue to process the; packet.. Caption: (errore caption)
[Figura da Pag.11] Labels: ¢ This field identifies the protocol used by the data carried in the data packet so that the IP layer of; the destination host sends the data to the process mapped to the Protocol field.; Version  ‘eader — Type of Total Length IP header| User data; Length Service n; Identification Flags Fragment Offset; TTL Header Checksum. Caption: (errore caption)
[Figura da Pag.11] Labels: Source IP Address 6/17 TCP/UDP; Destination IP Address; Options Padding 1 ICMP; Page 10 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.12] Labels: Contents; 1. Network Layer Protocols; 2. Introduction to IPv4 Addresses. Caption: (errore caption)
[Figura da Pag.12] Labels: 3. Subnetting; 4. ICMP; 5. ARP; 6. IPv4 Address Configuration and Basic Application. Caption: (errore caption)
[Figura da Pag.12] Labels: Page 11 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.13] Labels: Address Classification Address Calculation Special Addresses IPv4 vs. IPv6; What Is an IP Address?; ¢ An IP address identifies a node (or an interface on a network device) on a network.; ¢ |P addresses are used to forward IP packets on the network.. Caption: (errore caption)
[Figura da Pag.13] Labels: ©; ow as a IP Address; bestination | y's; address: Oe _ 7S) om -&- _; N N N ' - wee; iPS (iP 1) 1s “ s > An IP address identifies a; ef ©) 2 a, hort : node on a network and is; 72s) \ aa wm Tf ft yh used to find the destination. Caption: (errore caption)
[Figura da Pag.13] Labels: il ¢ a7 - we NC! for data, — i Oe; 1 N or data.; ‘ “N@) om; Data 17 K; Om.; Page 12 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.14] Labels: SEEN) Adcress classification Address Calculation  SpecialAddresses _—_IPv4vs. IPV6; IP address Notation; ¢ An IPv4 address is 32 bits long.; e |tis in dotted decimal notation.. Caption: (errore caption)
[Figura da Pag.14] Labels: Dotted decimal Decimal (ECE ECE bytes; notation Binary 11000000 10101000 00001010 00000001 32 bits; 2’ 2 > 24 2 2 2 2; Power; Conversion between 128 64 32 16 8 4 2 1; decimal and binarv. Caption: (errore caption)
[Figura da Pag.14] Labels: systems Bit 1 1 0 080 0 0 0 0; e |IPv4 address range is 0.0.0.0—255.255.255.255.; Page 13 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.15] Labels: Address Classification Address Calculation Special Addresses IPv4 vs. IPv6; IP Address Structure; ¢ Network part: identifies a network.; ¢ Host part: identifies a host and is used to differentiate hosts on a network.. Caption: (errore caption)
[Figura da Pag.15] Labels: Network part Host part; * Network mask: is used to distinguish the network part from the host part in an IP address.; 192. 168. 10.; 192.168.1011 11000000 10101000 00001010 00000001. IPaddress. Caption: (errore caption)
[Figura da Pag.15] Labels: 255.255.255.0 |1}1/1}1)1/1)1/1 1)1/1)1)1/1)1/}1 1)1/}1)1)1/1)1/}1 f 00000000 _ Network mask; . Network part Host part; Written as !; 192.168.10.1 255.255.255.0 = 192.168.10.1/24; Page 14 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.16] Labels: Address Classification Address Calculation Special Addresses IPv4 vs. IPv6; IP Addressing; ¢ Network part (network ID): identifies a network.; ¢ Host part: identifies a host and is used to differentiate hosts on a network.. Caption: (errore caption)
[Figura da Pag.16] Labels: Network part oy; Community A No. X, Street Y, John; Layer 2 network addressing Layer 3 network addressing; Community A (network bits); Layer 2 network Gateway Layer 2 network; ri... 26 i - _. Caption: (errore caption)
[Figura da Pag.16] Labels: (oor ae 10.0.1.0/24 — te 10.0.2.0/24; = ——— Cai 10.0.1.1/24  10.0.2.1/24 Ci; oe Ob oa ~; No. X, Street Y, John; (host bits) Layer 3 network; Page 15 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.17] Labels: Concepts rab Address Calculation  SpecialAddresses _—_IPv4vs. IPV6; IP Address Classification (Classful Addressing); ¢ To facilitate IP address management and networking, IP addresses are classified into the; following classes:. Caption: (errore caption)
[Figura da Pag.17] Labels: eee NNNNNNNN ff NNNNNNNN § NNNNNNNN SS eGo; ClassB —10NNNNNN NNNNNNNN NSIS (NNN 128.0.0.0-191.255.255.255 pssione -; Class C 110NNNNN NNNNNNNN NNNNNNNN [SSNS = 192.0.0.0-223.255.255.255; Class D 1110 224.0.0.0-239.255.255.255 | Used for multicast; Class E 1111 240.0.0.0-255.255.255.255 Used for research. Caption: (errore caption)
[Figura da Pag.17] Labels: * Default subnet masks of classes A, B, and C; ° Class A: 8 bits, 0.0.0.0-127.255.255.255/8; Network part; ° Class B: 16 bits, 128.0.0.0-191 .255.255.255/16; ° Class C: 24 bits, 192.0.0.0-223.255.255.255/24; Page 16 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.18] Labels: Concepts > cere Address Calculation Special Addresses IPv4 vs. IPv6; IP Address Types; e Anetwork range defined by a network ID is called a network segment.; ¢ Network address: identifies a network.. Caption: (errore caption)
[Figura da Pag.18] Labels: Cxample: 192.100.10.0/24; e Broadcast address: a special address used to send data > Networks land broadcast laddiesses; cannot be directly used by devices or; to all hosts on a network. _; their interfaces.; Example: 192.168.10.255/24; 192. 168. 10. 4444114 «+ Number of available addresses on a; network seqment is 29 — 2 (n is the. Caption: (errore caption)
[Figura da Pag.18] Labels: e Available addresses: IP addresses that can be allocated to number of bits in the host part).; device interfaces on a network.; Example: 192.168.10.1/24; 192. 168. 10. 00000001; Page 17 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.19] Labels: IP Address Calculation; ¢ Example: What are the network address, broadcast address, and number of available; addresses of class B address 172.16.10.1/16?; oo a iT ee. Caption: (errore caption)
[Figura da Pag.19] Labels: ua to: cc | Ge; [address 1]0]1/0/1|4]0/0}/0/0/0/1/0/0/0/0)}/0/0/0/0/1/0/1/0| |ojo/ojojojojo|1; Network mask 4)4/4)4/4]4/4]4]/41]4/4/4]4]4]4]4]}]0]0/0/0/0/0/0/0/ /o/o/o/ojol/ojojo; H The network address is obtained,; { with all host bits set to 0s.; Networkaddress 8910101100 00010000!00000000 00000000 17216.0.016; H The broadcast address is obtained,. Caption: (errore caption)
[Figura da Pag.19] Labels: Broadcast address; 10101100 00010000 1111411144 °111.1.1.11 14 475 46555 255/16; Number of IP 216 = 65536 i; addresses Quiz; Number of available 916 _ 9 = 65534 Example: What are the network address,; addresses broadcast address, and number of available; Range of available 172.16.0.1/16—172.16.255.254/16 addresses of class A address 10.128.20.10/8?; addresses; Page 18 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.20] Labels: Concepts Address Classification Address Calculation sD IPv4 vs. IPv6; Private IP Addresses; ¢ Public IP address: An IP address is assigned by the Internet Assigned Numbers Authority (IANA), and this; address allocation mode ensures that each IP address is unique on the Internet. Such an IP address is a; aeaspcic Ae Derma: TT ON onccedl ede:. Caption: (errore caption)
[Figura da Pag.20] Labels: PYUMIS Tr GAUUILCoOS.; ¢ Private IP address: In practice, some networks do not need to connect to the Internet. For example, on a; network of a lab in a college, IP addresses of devices need to avoid conflicting with each other only within; the same network. In the IP address space, some IP addresses of class A, B, and C addresses are; reserved for the preceding situations. These IP addresses are called private IP addresses.; a Class A: 10.0.0.0-10.255.255.255 Ta5 468 AOE. Caption: (errore caption)
[Figura da Pag.20] Labels: Class B: 172.16.0.0-172.31.255.255 aaa!; ol ass B: -16.0.0— OT. .; Implemented using network; Internet address translation (NAT); a Class C: 192.168.0.0-192.168.255.255; 10.0.0.0/8 192.168.1.0/24; Connecting a private network to the Internet; Page 19 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.21] Labels: Concepts Address Classification Address Calculation ab IPv4 vs. IPv6; Special IP Addresses; ¢ Some IP addresses in the IP address space are of special meanings and functions.; ¢ For example:. Caption: (errore caption)
[Figura da Pag.21] Labels: It can be used as a destination address and traffic destined for; Limited broadcast address = 255.255.255.255 it is sent to all hosts on the network segment to which the; address belongs. (Its usage is restricted by a gateway).; It is an address of any network.; Any IP address 0.0.0.0 Addresses in this block refer to source hosts on "this" network.; Lannharl addracce ANTNNNH/2 It le piead ta tact tha eanfhasara avietam nf 4 tact Anavinga. Caption: (errore caption)
[Figura da Pag.21] Labels: ieee ce ek See ee wean Se Me Gee ee ae ON Re) Sy eae een oes Mee eR: eee Cine eee; If a host fails to automatically obtain an IP address, the host; Link-local address 169.254.0.0/24 can use an IP address in this address block for temporary; communication.; Page 20 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.22] Labels: Concepts Address Classification Address Calculation Special Addresses; Pv4 vs. IPv6; e |IPv4 addresses managed by the IANA were exhausted in 2011. As the last public IPv4 address; was allocated and more and more users and devices access the public network, IPv4 addresses. Caption: (errore caption)
[Figura da Pag.22] Labels: were exhausted. This is the biggest driving force for IPv6 to replace IPv4.; + Address length: 32 bits « Address length: 128 bits; + Address types: unicast address, broadcast + Address types: unicast address, multicast; address, and multicast address address, and anycast address. Caption: (errore caption)
[Figura da Pag.22] Labels: * OUNnafacterstics. * Onafracteristics:; ° |Pv4 address depletion ° Unlimited number of addresses; ° |nappropriate packet header design ° Simplified packet header; o ARP dependency-induced flooding * Automatic IPv6 address allocation; Page 21 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.23] Labels: Contents; 1. Network Layer Protocols; 2. Introduction to |IPv4 Addresses. Caption: (errore caption)
[Figura da Pag.23] Labels: 3. Subnetting; 4. ICMP; 5. ARP; 6. IPv4 Address Configuration and Basic Application. Caption: (errore caption)
[Figura da Pag.23] Labels: Page 22 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.24] Labels: Why Subnetting?; i OL i 172.16.4.0; Lily CQ _; 479 1801 1479 18092 179 180952 179160 954 oe ee | (1g. Caption: (errore caption)
[Figura da Pag.24] Labels: Gi Ch ch ca 172.16.3.0 pt Fl; 172.16.0.0 i; 2'6 = 65536 IP addresses i hi ™; 172.16.2.0; # uncles B dociess! is used ‘tora broadcast * Anetwork number is divided into multiple. Caption: (errore caption)
[Figura da Pag.24] Labels: LN LED PLAS + subnets, and each subnet is allocated toa; * The broadcast domain is too large. Once separate broadcast domain.; broadcast occurs, an internal network is + Inthis way, the broadcast domain is smaller,; overloaded. and the network planning is more reasonable.; + IP addresses are properly used.; Page 23 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.25] Labels: Subnetting - Analyzing the Original Network; Segment; ¢ Example: 192.168.10.0/24. Caption: (errore caption)
[Figura da Pag.25] Labels: IP address 192. 168. 10. }o}0}0}0} 0/0} 0/1; Default subnet; mask 255. 255. 255. 00000000 One class C network:; . 192.168.10.0/24; 192.168.10.255 Default subnet mask:; IP add aft f a} aft} a]; address 192. 168. 10. 1|1}1/1/1/1]1]1 255.255.255.0; Default 255. 255. 255. 00000000; subnet mask. Caption: (errore caption)
[Figura da Pag.25] Labels: NetTWOrK Palit HOST palit; Network address: 192.168.10.0/24; Broadcast address: 192.168.10.255; Total IP addresses: 2° = 256; Available IP addresses: 2° - 2 = 254; Page 24 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.26] Labels: Subnetting - Taking Bits from the Host Part; ¢ Bits can be taken from the host part to create subnets.; Take 1 bit from the host part.. Caption: (errore caption)
[Figura da Pag.26] Labels: IP address 192. 168. 10. }o]0}0|0}0]0]0}o|; New mask 250i 250i 255i 10000000 Two subnets:; . Subnet 1: 192.168.10.0/25; Subnet 2: 192.168.10.128/25; Meecdicss| 192. 168. 10. New mask: 255.255.255.128; New mask 255. 209: 200: 10000000. Caption: (errore caption)
[Figura da Pag.26] Labels: Network part I Host part; Subnet bits; J Total IP addresses: 2’ = 128; * Variable length subnet mask (VLSM) Available IP addresses: 2’ — 2 = 126; Page 25 Copyright © 2020 Huawei Technologies Co., Ltd. Alll rights reserved.. Caption: (errore caption)
[Figura da Pag.27] Labels: Subnetting - Calculating the Subnet Network; Address; e The network address is obtained, with all host bits set to Os.. Caption: (errore caption)
[Figura da Pag.27] Labels: 192.168.10.0 192. 168. 10. 0/0/0/0/0;0;0/0; New mask /25 255. 255. 255. 10000000; Network part Host part; Subnet 1's; 192.168.10.0/25; network address we 188: to: }0}o|o/0/0/010/0. Caption: (errore caption)
[Figura da Pag.27] Labels: Subnet 2's; 192.168.10.128/25; network address 192. 168. 10. }1/0/0]0]0|0] 0/0]; Page 26 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.28] Labels: Subnetting - Calculating the Subnet; Broadcast Address; e The broadcast address is obtained, with all host bits set to 1s.. Caption: (errore caption)
[Figura da Pag.28] Labels: 192.168.10.0 192. 168. 10. 0/0/0/0/0;0;0/0; New mask /25 255. 255. 255. 1/0/0;0)0/0/0/0; Network part Host part; Subnet 1's; 192.168.10.0/25; network address we nce: ie: }0}o|o/0/0/010/0; Subnet 1's lalalalalalalay; ee 192. 168. 10. 0/4 See) 192.168.10.127/25. Caption: (errore caption)
[Figura da Pag.28] Labels: Subnet 2's; 192.168.10.128/25; network address 192. 168. 10. }1/0/0]0]0|0] 0/0]; Subnet 2's; 192. 168. 10. 1)/1/1/111/1]1 192.168.10.255/25; broadcast address; Page 27 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.29] Labels: Practice: Computing Subnets (1); * Question: An existing class C network segment; is 192.168.1.0/24. Use the VLSM to allocate IP; addresses to three subnets.; 10 hosts. Caption: (errore caption)
[Figura da Pag.29] Labels: Ci . Chk 30 hosts; = = = ¢ Answer: (Use a network with 10 hosts as an example.); i Step 1: Calculate the number of host bits to be taken.; 2°-2210; & & i n2 4, host bits; : Step 2: Take bits from the host part.; kK K = Take 4 bits from the host part.. Caption: (errore caption)
[Figura da Pag.29] Labels: —eEe_Ee —_eEe** SS =a; 10 hosts IPaddress 192. 168. 1. 00000000; Subnet mask 255. 255. 255. 11110000; Subnet bits |§ Number of subnets:; 2* = 16 subnets; Page 28 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.30] Labels: Practice: Computing Subnets (2); * Question: An existing class C network segment; 192:168:1:0/28 is 192.168.1.0/24. Use the VLSM to allocate IP; onl GS addresses to three subnets.. Caption: (errore caption)
[Figura da Pag.30] Labels: Ci ve Ci 30 hosts « Answer: (Use a network with 10 hosts as an example.); —T TT i Step 3: Calculate subnet network addresses.;  §- 2 ~ IP address 192. 168. 1. 00000000; ® ® i New mask 255. 255. 255. 1 1110000; ~ Network address; a as Subnet? 192. 168. 1. EXE o 0 0 0 192.168.1.0/28. Caption: (errore caption)
[Figura da Pag.30] Labels: a a SS 192.168.1.16/28; Honects =a Subnet2 192 168. 1. (Y/UI 0 0 0 0; 192.168.1.16/28 Subnet3 192. 168. 1. [IPI o 0 0 0 192.168.1.32/28; Subnet 16 192. 168. 1. [EJJENMENR 0 0 0 0 192.168.1.240/28; Page 29 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.31] Labels: Contents; 1. Network Layer Protocols; 2. Introduction to |IPv4 Addresses. Caption: (errore caption)
[Figura da Pag.31] Labels: 3. Subnetting; 4. ICMP; 5. ARP; 6. IPv4 Address Configuration and Basic Application. Caption: (errore caption)
[Figura da Pag.31] Labels: Page 30 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.32] Labels: ¢ The Internet Control Message Protocol (ICMP) is an auxiliary protocol of the IP protocol.; -_ i ie.) ee a: eS aa: | eee: mee, | Ethernet IP ee a) ee er ee |. Caption: (errore caption)
[Figura da Pag.32] Labels: a TA IVET IO UVeUY LY LIAO EI Gb VMI NWP He ooaye CUIerlet tall; header header; information between network devices. It plays; an important role in collecting network Type | ‘Gove Shecksum; information, diagnosing and rectifying network ICMP message content; faults. Fype |code |Description; 0 0 Echo Reply; — a Message : 3 0 Network Unreachable. Caption: (errore caption)
[Figura da Pag.32] Labels: _— > ——; ih _ 3: 1 Host Unreachable; 7 hn; Host A Massage 3 2 Protocol Unreachable; 3 3 Port Unreachable; 5 0 Redirect; 8 0 Echo Request; Page 31 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.33] Labels: ICMP Redirection; ¢ ICMP Redirect messages are a type of ICMP control message. When a router detects that a; host uses a non-optimal route in a specific scenario, the router sends an ICMP Redirect. Caption: (errore caption)
[Figura da Pag.33] Labels: message to the host, requesting the host to change the route.; Server A Internet; 20.0.0.1/24; 20.0.0.2/24; RT & & RT; A s S B. Caption: (errore caption)
[Figura da Pag.33] Labels: 10.0.0.200/24 (3] (1) 4 10.0.0.100/24; 1; prcceceeeneeet; H; ! @) ICMP Redirect message; paces im IP address: 10.0.0.1/24; OS Default gateway: 10.0.0.100; Page 32 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.34] Labels: ICMP Error Detection; e ICMP Echo messages are used to check network connectivity between the source and; destination and provide other information, such as the round-trip time.. Caption: (errore caption)
[Figura da Pag.34] Labels: Echo [RTA]ping 20.0.0.2; Request PING 20.0.0.2: 56 data bytes, press CTRL_C to break; 10.0.0.0/24 20.0.0.0/24 Reply from 20.0.0.2: bytes=56 Sequence=1 ttl=254 time=70 ms; & ; ; ; ; Fi Reply from 20.0.0.2: bytes=56 Sequence=2 ttl=254 time=30 ms; RT 1 2 ret 1 a 2 ServerA Reply from 20.0.0.2: bytes=56 Sequence=3 ttl=254 time=30 ms; A B Reply Reply from 20.0.0.2: bytes=56 Sequence=4 ttl=254 time=40 ms; Reply from 20.0.0.2: bytes=56 Sequence=5 ttl=254 time=30 ms; itis ‘Dink --- 20.0.0.2 ping statistics ---. Caption: (errore caption)
[Figura da Pag.34] Labels: ees 5 packet(s) transmitted; Ping is a command used on network devices, Windows OS, Unix 5 packet(s) received; OS, and Linux OS. Ping is a small and useful application based on 0.00% packet loss; the ICMP protocol. round-trip min/avg/max = 30/40/70 ms; Aping tests the reachability of a destination node.; Page 33 = Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.35] Labels: ICMP Error Report; e ICMP defines various error messages for diagnosing network connectivity problems. The source can; determine the cause for a data transmission failure based on the received error messages. For example,; giaiiaek <a teenie aaaet et pl pk Fie “We TE eS acne oS: pee | rao men wlewe wxcmcbenemeeta cCaseucecse whee cabaewedkvenuebioxwe hiuecaeweus. Caption: (errore caption)
[Figura da Pag.35] Labels: AIS A TEIWYVITR MEV IV@ TEUPIVes A PAYAL, TE VATE AUUeoo LIS TIOLVVUITIN VWWEIOIe Le UC OLITGUV IT USVINe; resides, the network device automatically sends an ICMP Destination Unreachable message to the source.; Data packet [RTA]tracert 20.0.0.2; —_——; & 10.0.0.0/24 & 20.0.0.0/24 E traceroute to 20.0.0.2(20.0.0.2), max hops: 30 ,packet length:; A 2 A 2 40,press CTRL_C; RTA RTB ServerA to break; ———_—_; pee ee er eee ee oe ey Cn oe a a. Caption: (errore caption)
[Figura da Pag.35] Labels: eed T 10.0.0.2 00 ms 10 ms 10 ms; Function: Tracert; Tracert checks the reachability of each hop on a forwarding path 2 20.0.0.2 30 ms 30 ms 20 ms; based on the TTL value carried in the packet header.; Tracert is an effective method to detect packet loss and delay ona; network and helps administrators discover routing loops on the; network.; Page 34 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.36] Labels: Contents; 1. Network Layer Protocols; 2. Introduction to |IPv4 Addresses. Caption: (errore caption)
[Figura da Pag.36] Labels: 3. Subnetting; 4. ICMP; 5. ARP; 6. IPv4 Address Configuration and Basic Application. Caption: (errore caption)
[Figura da Pag.36] Labels: Page 35 = Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.37] Labels: Application Transport Network Se; Layer Layer Layer Layer Layer; ¢ Address Resolution Protocol (ARP):; o Discovers the MAC address associated with a given IP address.. Caption: (errore caption)
[Figura da Pag.37] Labels: ARP request; Destination IP address: 192.168.1.2; Destination MAC address: ?; a _]; Host A _j}—--—_-—___.——__] Host B; 192.168.1.1/24 == _— 192.168.1.2/24; 3C-52-82-49-7E-9D ARP reply 48-A4-72-1C-8F-4F; Source IP address: 192.168.1.2. Caption: (errore caption)
[Figura da Pag.37] Labels: Source MAC address: 48-A4-/2-1C-8F-4F; Page 36 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.38] Labels: Application Transport Network Physical; Layer Layer Layer Layer Layer; . . .; ARP Implementation Principles (1); §,; Host 1 checks Host 1 & Host 2; rarhed ARD anftriac _: =. Caption: (errore caption)
[Figura da Pag.38] Labels: rr a = GE 0/0/1 GE 0/0/2 =; Host 1 sends an ARP; request. —; } IP 1: 192.168.1.1/24 IP 2:192.168.1.2/24; Host 2 adds an ARP MAC 1: 3C-52-82-49-7E-9D MAC 2: 48-A4-72-1C-8F-4F; entry. 1); Host 2 sends an ARP Step 1:; reply. Host 1 :; | lost 1>arp -a ; + Before sending a datagram, a device searches; InternetAddress PhysicalAddress Type its ARP table for the destination MAC address of. Caption: (errore caption)
[Figura da Pag.38] Labels: Host 1 adds an ARP the datagram.; entry. a. tei; + — Ifthe destination MAC address exists in the; ARP table, the device encapsulates the MAC; The ARP cache address in the frame and sends out the frame. If; table is empty. the destination MAC address does not exist in; the ARP table, the device sends an ARP request; to discover the MAC address.; Page 37 = Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.39] Labels: Application Transport Network Se; Layer Layer Layer Layer Layer; . . .; ARP Implementation Principles (2); Host 1 checks cached Host 1 & Host 2; ARD anftriac = , ~~ Tr. t—‘sé~‘*S. Caption: (errore caption)
[Figura da Pag.39] Labels: an ae = W Geo GE 0/0/2 =; Host 1 sends an ARP —— —; request. — —; IP 1: 192.168.1.1/24 IP 2: 192.168.1.2/24; Host 2 adds an ARP MAC 1: 3C-52-82-49-7E-9D MAC 2:48-A4-72-1C-8F-4F; entry.; } <a] Step 2:; Host 2 sends an ARP 2) + Host 1 sends an ARP request to discover; reply. Eth_ll ARP Request FCS the MAC address of Host 2.; | ss a | * The destination MAC address in the ARP. Caption: (errore caption)
[Figura da Pag.39] Labels: Host 1 adds an ARP v request Is 0 because the destination MAC; entry. Destination MAC address is unknown.; address: Operation type:; FE-FF-FF{EF:FF2FF MAC address of the sender: MAC 1; Source MAC address: _!P address of the sender: IP 1 Step 3:; MAC 1 Destination MAC address: + The ARP request message is a broadcast; Destination IP address: IP 2 data frame. After receiving the ARP request; message, the switch floods it.; Page 38 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.40] Labels: Application Transport Network Physical; Layer Layer Layer Layer Layer; . . .; ARP Implementation Principles (3); §,; Host 1 checks Host 1 ey Host 2; rarhead ARD aeanftriac rr. t~‘s‘Sér =. Caption: (errore caption)
[Figura da Pag.40] Labels: an 1 ae = GE 0/0/14 GE 0/0/2 =; Host 1 sends an ARP; request. — —; IP 1: 192.168.1.1/24 IP 2: 192.168.1.2/24; Host 2 adds an ARP MAC 1: 3C-52-82-49-7E-9D MAC 2: 48-A4-72-1C-8F-4F; entry. 4); Step 4:; Host 2 sends an ARP _; reply. + After receiving the ARP request message, each host Host 2>arp -a; | checks whether it is the destination of the message based Internet Address Physical Address Type; on the carried destination IP address. 192.168.1.1 3C-52-82-49-7E-9D Dynamic. Caption: (errore caption)
[Figura da Pag.40] Labels: Host 1 add ARP /; ee one + Host 2 finds that it is the destination of the message and; - then records the mapping between the sender's MAC and; IP addresses in its ARP table.; Page 39 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.41] Labels: Application Transport Network Physical; Layer Layer Layer Layer Layer; . . .; ARP Implementation Principles (4); §,; Host 1 checks Host 1 ey Host 2; rached ARD entriac = , 6h” =. Caption: (errore caption)
[Figura da Pag.41] Labels: an | ae = GE 0/0/14 GEO/0/2 Ww =; Host 1 sends an ARP . .; request. — —; } IP 1: 192.168.1.1/24 IP 2: 192.168.1.2/24; Host 2 adds an ARP MAC 1: 3C-52-82-49-7E-9D MAC 2: 48-A4-72-1C-8F-4F; entry.; Step 5:; Host 2 sends an ARP + Host 2 sends anARP reply to Host 1.; reply. + Inthis step, Host 2 has discovered the MAC address of Host Eth_ll ARP Reply FCS; 1, so the ARP reply is a unicast data frame. ry. Caption: (errore caption)
[Figura da Pag.41] Labels: Host 1 adds an ARP. ,; entry. Destination MAC; address: MAC-1 Operation type:; Step 6: Source MAC address: — Sender's MAC address:; p MAC 2 Sender's IP address:; + After receiving the unicast data frame, the switch forwards the ane NRGradtionc. MAC 1; amet Receiver's IP address: IP 1; Page 40 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.42] Labels: Application Transport Network Physical; Layer Layer Layer Layer Layer; . . .; ARP Implementation Principles (5); Host 1 checks Host 1 ey Host 2; rarhead ARD aeanftriac r.—t—‘sé‘~*S =. Caption: (errore caption)
[Figura da Pag.42] Labels: a ry ae I GE 0/0/1 GE 0/0/2 =; Host 1 sends an ARP; request. — —; 1 IP 1: 192.168.1.1/24 IP 2: 192.168.1.2/24; Host 2 adds an ARP MAC 1: 3C-52-82-49-7E-9D MAC 2: 48-A4-72-1C-8F-4F; entry. 7); ' Step 7:; Host 2 sends an ARP; reply. Host 1>arp -a + After receiving the ARP reply message, Host 1 checks; Internet Address Physical Address Type whether it is the destination of the message based on; en 192.168.1.2 48-A4-72-1C-8F-4F Dynamic the carried destination IP address.. Caption: (errore caption)
[Figura da Pag.42] Labels: Host 1 add ARP :; oo Gen + — Ifso, Host 1 records the carried sender's MAC and IP; = addresses in its ARP table.; Page 41 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.43] Labels: Contents; 1. Network Layer Protocols; 2. Introduction to |IPv4 Addresses. Caption: (errore caption)
[Figura da Pag.43] Labels: 3. Subnetting; 4. ICMP; 5. ARP; 6. IPv4 Address Configuration and Basic Application. Caption: (errore caption)
[Figura da Pag.43] Labels: Page 42 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.44] Labels: Basic IP Address Configuration Commands; 1. Enter the interface view.; [Huawei] interface interface-type interface-number. Caption: (errore caption)
[Figura da Pag.44] Labels: You can run this command to enter the view of a specified interface and configure attributes for the interface.; + interface-type interface-number. specifies the type and number of an interface. The interface type and number; can be closely next to each other or separated by a space character.; 2. Configure an IP address for the interface.; [Huawei-GigabitEthernet0/0/1] ip address ip-address { mask | mask-length }; You can run this command in the interface view to assign an IP address to the interface on the network devices to. Caption: (errore caption)
[Figura da Pag.44] Labels: implement network interconnection.; + jp-address: specifies the IP address of an interface. The value is in dotted decimal notation.; * mask: specifies a subnet mask. The value is in dotted decimal notation.; « mask-length: specifies a mask length. The value is an integer ranging from 0 to 32.; Page 43 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.45] Labels: Configuring an IP address for an Interface; Configure an IP address for a physical interface.; 192.168.1.1/24 192.168.1.2/24; Bo BS [RTA] interface gigabitethernet 0/0/1. Caption: (errore caption)
[Figura da Pag.45] Labels: SCV SCV oe i; [RTA-GigabitEthernet0/0/1] ip address 192.168.1.1 255.255.255.0; RTA RTB a; LSonBEEK.O LSonBHEK.O [RTA-GigabitEthernet0/0/1] ip address 192.168.1.1 24; 1.1.1.1/32 2.2.2.2/32; Configure an IP address for a logical interface.; On the preceding network where the two ;; ’ : [RTA] interface LoopBack 0; raittore ara intarnnnnortod pnnnfinrira |D. Caption: (errore caption)
[Figura da Pag.45] Labels: 2a [RTA-LoopBack0] ip address 1.1.1.1 255.255.255.255; addresses for the interconnected physical 6; interfaces and logical IP addresses. :; [RTA-LoopBackO] ip address 1.1.1.1 32; Page 44 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)
[Figura da Pag.46] Labels: Network IP Address Planning; ¢ IP address planning must be considered together with the network structure, routing protocols,; traffic planning, and service rules. In addition, IP address planning should be corresponding to. Caption: (errore caption)
[Figura da Pag.46] Labels: LHI TIOUVUIRN THCLAPOLY Gi VOLIVUIITOU THT a lUP VMULLUITET Way.; ¢ In conclusion, IP address planning objectives are to achieve easy management, easy scalability,; and high utilization. Reference Planning Rules; * IP Address Planning Example Uniqueness, continuity, and scalability; Structured and service-related; Network segment of the 192 168.1.0/24 Core node. Caption: (errore caption)
[Figura da Pag.46] Labels: Le Se ee eee; Example:; : Network segment of the .; Acompany is marketing department 192.168.2.0/24 Aggregation node; assigned; 192.168.0.0/16 Network segmentofthe 199 168 3.0/24; as a network administrative department; segment Access node; address. Network segment ofthe 499 168.4.0/24; guest center REDDER! Marketing Administration Guest; Others . Ph Dept. Dept. center; Page 45 Copyright © 2020 Huawei Technologies Co., Ltd. All rights reserved.. Caption: (errore caption)